PENSUM — Bridge to Phase 4 and Full Phase 4 — Blocks and Deliverables (v1.0)

    Start: immediately after closing Phase 3 (post-2027-08-03 per plan)
    Planned dedication: 5 h/day (Mon–Sat)
    Methodology: PBR (reproducible labs) + PAD (analysis and documentation)
    Ethical scope: everything in an isolated lab under OPSEC/Legal controls. Training purposes only.

Bridge to Phase 4 (1–2 week pre-flight)

Purpose: ensure technical and operational continuity before entering evasion/persistence/C2.

Checklist

    Freeze F3: tag stable versions of Phase 3 tools and exploits; clean snapshots.

    Blue baseline (8B placeholder): update Sysmon/ETW, Sigma/YARA rules, and KQL queries; export an initial dashboard.

    C2 selection: define channel (HTTP(S)/DNS/TCP) and minimal profiles; beacon templates with controlled jitter.

    Test environment: VM matrix by OS/patch level; reproducible users and policies.

    OPSEC/Legal: review build policies, metadata, compartmentalization, and explicit consent within the lab.

PBR (pre-flight)

    Compatibility matrix (OS, patches, tools) with evidence.

    Exportable Blue dashboard (screenshots + versioned rules/queries).

    Blank C2 connectivity PoC: chosen channel, stable heartbeat, no operational payload.

PAD

    Pre-flight report with risks and mitigation plan.

Phase 4 — Vision

Build an end-to-end covert operational chain: Initial Access (8A) → Evasion/Obfuscation → Persistence → C2 → Blue validation (8B), 
with optional extensions on macOS/Linux EDR and Android. The phase closes with a covert-operations Capstone in the lab.

Expected outputs

    Stable implant/loader with measured evasion.

    Two persistence mechanisms verified per OS.

    Documented C2 profile exercised in a realistic lab scenario.

    Defensive rules/queries and before/after comparative evaluation.

8A — Initial Access and Covert Delivery (1–2 weeks)

Goal: build 2 reproducible delivery chains that establish a C2 session with low telemetry signal.

Content

    Modern maldocs (VBA / XLM 4.0), Trust Center, signing.

    Shortcuts/hosted: LNK, HTA, JS/JScript, COM Scriptlets; Mark-of-the-Web.

    AMSI (operational view): userland hooking and limits; lab-legal alternatives.

    LOLBins/WMIC/WMI: controlled execution in the lab.

PBR

    Two end-to-end chains: 1 maldoc and 1 LNK/HTA → C2.

PAD

    Evidence, IOC list, and plausible defensive mitigations.

8B — Minimum Blue Track (1 week)

Goal: quantitative baseline and dashboard to validate bypass.

Content

    Key Sysmon/ETW providers.

    Minimal YARA/Sigma rules with tuning.

    Essential KQL queries.

PBR

    48-hour baseline and a versioned set of rules/queries.

PAD

    Comparative report before/after executing 8A chains.

F4-B1 — Evasion I: anti-analysis and detection surface

Duration: 3 weeks
Goal: reduce signal generated by loaders/implants in userland.

Content

    Intro to anti-debug/anti-VM and pedagogical limits.

    Dynamic API resolution and name hashing.

    String obfuscation and configuration data protection.

    Direct syscalls at a high level (SSN resolution; no aggressive unhooking details).

    Time/sleep management and common artifacts.

PBR

    Loader with dynamic resolution and obfuscated strings.

    Telemetry comparison (8B) before/after.

PAD

    Report on detection surfaces affected and residual risks.

F4-B2 — Evasion II: advanced userland injection

Duration: 3 weeks
Goal: implement 2 additional techniques with a better noise profile.

Content

    Early-bird APC, thread-less, and module stomping (didactic view).

    Process creation options: PPID spoofing and relevant flags.

    Permission handling and post-execution cleanup.

PBR

    Implement 2 additional techniques selectable via CLI.

    Comparative artifact table vs baseline (8B).

PAD

    Analysis of trade-offs for each technique and lab-operational recommendations.

9B — Implant Crypto and Packer v2 (2 weeks)

Goal: harden comms and packaging with AEAD and light mutation.

Content

    AEAD (AES-GCM or ChaCha20-Poly1305): nonces, rotation, session keys.

    Config sealing and key pinning.

    Packer v2: instruction substitution, light flattening, noise in import hash.

    Compatibility and performance harness.

PBR

    Integrate a minimal crypto library and packer v2 into an existing implant.

PAD

    Test and security report (failures, mitigations, performance).

F4-B3 — Cross-platform persistence (Windows/Linux/macOS)

Duration: 3 weeks
Goal: establish and verify 2 persistence methods per OS in lab.

Content

    Windows: Run keys/RunOnce, Scheduled Tasks, Services, WMI permanent event consumers, AppInit_DLLs/IFEO (lab).

    Linux: systemd user services, cron.d, shell profiles; LD_PRELOAD notes in a controlled setting.

    macOS: LaunchAgents/LaunchDaemons, LoginItems; signing/notarization in lab.

PBR

    Two methods verified per OS with boot/execution evidence.

PAD

    Risk table, typical detections, and safe rollback per method.

F4-B4 — Covert C2 and traffic profiling

Duration: 3 weeks
Goal: design and operate a C2 profile with realistic traffic patterns in lab.

Content

    Client profiles: jitter, intervals, sizes, headers.

    Basic client mimicry (UA, paths, timings).

    JA3/JA3S and TLS fingerprint considerations at a high level.

    Channel options: HTTP(S)/DNS/TCP; boundaries and risks.

    Lab infrastructure rotation.

PBR

    Documented C2 profile measured against the blue baseline.

    72-hour run with logs and signal-vs-noise report.

PAD

    Comms OPSEC report and contingency plan.

F4-B5 — Covert operations and controlled movement (lab)

Duration: 2 weeks
Goal: carry out minimal operational tasks without obvious signal in the lab.

Content

    Controlled system/inventory collection.

    WMI/PSRemoting in a test environment with clear limits.

    Artifact cleanup and rollback.

    TTP documentation with ATT&CK mapping.

PBR

    Playbook of 5 operational tasks with evidence and blue evaluation.

PAD

    Risk report and containment measures.

F4 Extensions 
12A — macOS Internals + EndpointSecurity (1 week)

Goal: understand macOS security pipeline and build minimal event PoCs via EndpointSecurity.
PBR: simple loader, event PoC, build guide.
PAD: notes on notarization/ad-hoc, TCC, and limits.
12B — Linux Hardening/EDR and eBPF (1 week)

Goal: grasp common Linux defenses and lab evasion tactics.
PBR: simulated detections and evasion; basic Falco/eBPF rules.
PAD: findings report and adjustments.
12C — Android ARM64 + basic Frida (1 week)

12D — Hardware RE Basics (1–2 weeks)

UART/JTAG/SWD with OpenOCD/Black Magic, CH341A for SPI flash, 8-channel logic analyzer.

PBR: sample firmware dump/restore with verified rollback.
PAD: safe wiring guide and risk checklist.

12E — Bus Sniffers & Firmware Pipeline (1 week)

Python decoders for UART/I²C/SPI, hashing/compare scripts, validation harness.

PBR:reproducible `dump → verify → restore` pipeline in a VM.
PAD: evidence and usage limits.

12F — Glitching/FPGA Lite (1–2 weeks)

ChipWhisperer-Lite or iCE40 for controlled PoCs.

PBR: educational PoC with guaranteed rollback.
PAD: risks and mitigations.

Goal: introduce mobile surface with trivial hooking and evasion in a test app.
PBR: simple hook; PAD: lab notes and risks.
Express Module — OPSEC/Legal (3–5 days)

Goal: reduce IOCs and operational risk.

Content: compartmentalized environments, reproducible signing, secret handling, metadata minimization.
Deliverable: checklist applied across all Phase 4 repos.
F4-CAP — Phase 4 Capstone: Integrated covert operation in lab (2–3 weeks)

Goal: chain 8A → Evasion (B1/B2) → Persistence (B3) → C2 (B4) → Blue evaluation (8B) over a 96-hour scenario, with ATT&CK mapping and a technical defense.

Activities

    Prepare implant/loader with packer v2 and integrated crypto.

    Execute the 8A delivery chain and establish persistence.

    Operate C2 using the defined profile and B5 tasks.

    Measure signal vs noise with the Blue dashboard and tune.

Deliverables

    capstone-f4/ repo with code, scripts, and a reproducible README.

    Evidence (logs, screenshots, hashsets), tuned rules/queries, and a technical defense (slides/brief).

Success criteria

    Chain reproducible in lab for 96 hours, measurable signal reduction vs baseline, and a convincing defense.

Phase 4 — Grading rubric

    A: All PBR/PAD complete; stable implant/loader; verified persistence; measured C2 profile; strong Capstone with data-driven improvements.

    B: ≥80% PBR/PAD; one unstable component but documented; functional Capstone.

    C: ≥60% PBR/PAD; partial reproducibility or weak blue validation.

    Redo: <60% or lack of evidence/defense.

Dependencies and suggested order

    Bridge (pre-flight)

    8A → 8B

    F4-B1 → F4-B2

    9B (crypto/packer v2)

    F4-B3 → F4-B4 → F4-B5

    Extensions 12A–C (per hardware/interest)

    OPSEC/Legal (review and sign)

    F4-CAP

Outcome

Phase 4 delivers a complete operational chain with implant/loader, measured evasion, verifiable persistence, 
and a C2 profile with realistic traffic, plus your own defensive rules/queries. Direct foundation for Phase 5 (kernel/firmware).
